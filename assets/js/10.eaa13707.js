(window.webpackJsonp=window.webpackJsonp||[]).push([[10],{350:function(a,e,s){"use strict";s.r(e);var t=s(12),n=Object(t.a)({},(function(){var a=this,e=a.$createElement,s=a._self._c||e;return s("ContentSlotsDistributor",{attrs:{"slot-key":a.$parent.slotKey}},[s("h1",{attrs:{id:"install-flagger"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#install-flagger"}},[a._v("#")]),a._v(" Install Flagger")]),a._v(" "),s("p",[a._v("Add Flagger Helm repository:")]),a._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[a._v("helm repo "),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("add")]),a._v(" flagger https://flagger.app\n")])])]),s("p",[a._v("Output:")]),a._v(" "),s("div",{staticClass:"language-text extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v('"flagger" has been added to your repositories\n')])])]),s("p",[a._v("Install Flagger's custom resource definitions:")]),a._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[a._v("kubectl apply -f https://raw.githubusercontent.com/weaveworks/flagger/master/artifacts/flagger/crd.yaml\n")])])]),s("p",[a._v("Output:")]),a._v(" "),s("div",{staticClass:"language-text extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v("customresourcedefinition.apiextensions.k8s.io/canaries.flagger.app created\n")])])]),s("p",[a._v("To install the chart with the release name "),s("code",[a._v("flagger")]),a._v(" for Istio:")]),a._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[a._v("helm "),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("install")]),a._v(" --name flagger --namespace"),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("istio-system flagger/flagger --version "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("0.18")]),a._v(".4 --wait "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("\n  --set crd.create"),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"false"')]),a._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("\n  --set "),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("logLevel")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"debug"')]),a._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("\n  --set "),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("meshProvider")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"istio"')]),a._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("\n  --set "),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("metricsServer")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"http://prometheus:9090"')]),a._v("\n")])])]),s("p",[a._v("Output:")]),a._v(" "),s("div",{staticClass:"language-text extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v("NAME:   flagger\nLAST DEPLOYED: Thu Sep 19 08:22:43 2019\nNAMESPACE: istio-system\nSTATUS: DEPLOYED\n\nRESOURCES:\n==> v1/Deployment\nNAME     READY  UP-TO-DATE  AVAILABLE  AGE\nflagger  1/1    1           1          20s\n\n==> v1/Pod(related)\nNAME                      READY  STATUS   RESTARTS  AGE\nflagger-78957f5cf9-xxsb7  1/1    Running  0         20s\n\n==> v1/ServiceAccount\nNAME     SECRETS  AGE\nflagger  1        20s\n\n==> v1beta1/ClusterRole\nNAME     AGE\nflagger  20s\n\n==> v1beta1/ClusterRoleBinding\nNAME     AGE\nflagger  20s\n\n\nNOTES:\nFlagger installed\n")])])]),s("p",[a._v("Install Flagger's Grafana Helm Release:")]),a._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[a._v("helm "),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("install")]),a._v(" --name flagger-grafana --namespace"),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("istio-system flagger/grafana --version "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("1.3")]),a._v(".0 "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("\n  --set "),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("password")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("admin "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("\n  --set "),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("url")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("http://prometheus:9090 "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("\n  --set "),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("user")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("admin\n")])])]),s("p",[a._v("Output:")]),a._v(" "),s("div",{staticClass:"language-text extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v("NAME:   flagger-grafana\nLAST DEPLOYED: Thu Sep 19 08:23:36 2019\nNAMESPACE: istio-system\nSTATUS: DEPLOYED\n\nRESOURCES:\n==> v1/ConfigMap\nNAME                         DATA  AGE\nflagger-grafana-dashboards   2     0s\nflagger-grafana-datasources  1     0s\nflagger-grafana-providers    1     0s\n\n==> v1/Pod(related)\nNAME                              READY  STATUS             RESTARTS  AGE\nflagger-grafana-66ffcb79b6-rbwpn  0/1    ContainerCreating  0         0s\n\n==> v1/Service\nNAME             TYPE       CLUSTER-IP    EXTERNAL-IP  PORT(S)  AGE\nflagger-grafana  ClusterIP  10.0.145.140  <none>       80/TCP   0s\n\n==> v1beta2/Deployment\nNAME             READY  UP-TO-DATE  AVAILABLE  AGE\nflagger-grafana  0/1    1           0          0s\n\n\nNOTES:\n1. Run the port forward command:\n\nkubectl -n istio-system port-forward svc/flagger-grafana 3000:80\n\n2. Navigate to:\n\nhttp://localhost:3000\n")])])]),s("p",[a._v("Expose "),s("code",[a._v("flagger-grafana")]),a._v(" outside:")]),a._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[a._v("cat")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("<<")]),a._v(" EOF "),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("|")]),a._v(" kubectl apply -f -\napiVersion: networking.istio.io/v1alpha3\nkind: Gateway\nmetadata:\n  name: flagger-grafana-gateway\n  namespace: istio-system\nspec:\n  selector:\n    istio: ingressgateway\n  servers:\n  - port:\n      number: "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("80")]),a._v("\n      name: http-flagger-grafana\n      protocol: HTTP\n    hosts:\n    - flagger-grafana."),s("span",{pre:!0,attrs:{class:"token variable"}},[a._v("${MY_DOMAIN}")]),a._v("\n  - port:\n      number: "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("443")]),a._v("\n      name: https-flagger-grafana\n      protocol: HTTPS\n    hosts:\n    - flagger-grafana."),s("span",{pre:!0,attrs:{class:"token variable"}},[a._v("${MY_DOMAIN}")]),a._v("\n    tls:\n      credentialName: ingress-cert-"),s("span",{pre:!0,attrs:{class:"token variable"}},[a._v("${LETSENCRYPT_ENVIRONMENT}")]),a._v("\n      mode: SIMPLE\n      privateKey: sds\n      serverCertificate: sds\n---\napiVersion: networking.istio.io/v1alpha3\nkind: VirtualService\nmetadata:\n  name: flagger-grafana-virtual-service\n  namespace: istio-system\nspec:\n  hosts:\n  - flagger-grafana."),s("span",{pre:!0,attrs:{class:"token variable"}},[a._v("${MY_DOMAIN}")]),a._v("\n  gateways:\n  - flagger-grafana-gateway\n  http:\n  - route:\n    - destination:\n        host: flagger-grafana.istio-system.svc.cluster.local\n        port:\n          number: "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("80")]),a._v("\nEOF\n")])])]),s("p",[a._v("Output:")]),a._v(" "),s("div",{staticClass:"language-text extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v("gateway.networking.istio.io/flagger-grafana-gateway created\nvirtualservice.networking.istio.io/flagger-grafana-virtual-service created\n")])])]),s("p",[a._v("The Grafana with Flagger dashboards should be here: "),s("a",{attrs:{href:"https://flagger-grafana.myexample.dev",target:"_blank",rel:"noopener noreferrer"}},[a._v("https://flagger-grafana.myexample.dev"),s("OutboundLink")],1)])])}),[],!1,null,null,null);e.default=n.exports}}]);